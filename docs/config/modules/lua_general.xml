<?xml version="1.0"?>
<section xmlns="http://docbook.org/ns/docbook" version="5">
  <title>lua_general</title>
  <para>The lua_general module allows running of arbitrary lua code at startup.</para>
  <variablelist>
    <varlistentry>
      <term>loader</term>
      <listitem>
        <para>C</para>
      </listitem>
    </varlistentry>
    <varlistentry>
      <term>image</term>
      <listitem>
        <para>lua_mtev.so</para>
      </listitem>
    </varlistentry>
  </variablelist>
  <section>
    <title>Module Configuration</title>
    <variablelist>
      <varlistentry>
        <term>directory</term>
        <listitem>
          <variablelist>
            <varlistentry>
              <term>required</term>
              <listitem>
                <para>optional</para>
              </listitem>
            </varlistentry>
            <varlistentry>
              <term>default</term>
              <listitem>
                <para>/install/prefix/libexec/mtev/lua/?.lua</para>
              </listitem>
            </varlistentry>
            <varlistentry>
              <term>allowed</term>
              <listitem>
                <para>.+</para>
              </listitem>
            </varlistentry>
          </variablelist>
          <para>This is the lua load path.  See the lua manual for more details on meaning and syntax.</para>
        </listitem>
      </varlistentry>
    </variablelist>
    <variablelist>
      <varlistentry>
        <term>cpath</term>
        <listitem>
          <variablelist>
            <varlistentry>
              <term>required</term>
              <listitem>
                <para>optional</para>
              </listitem>
            </varlistentry>
            <varlistentry>
              <term>default</term>
              <listitem>
                <para/>
              </listitem>
            </varlistentry>
            <varlistentry>
              <term>allowed</term>
              <listitem>
                <para>.+</para>
              </listitem>
            </varlistentry>
          </variablelist>
          <para>This is the lua DSO load path.  See the lua manual for more details on meaning and syntax.</para>
        </listitem>
      </varlistentry>
    </variablelist>
    <variablelist>
      <varlistentry>
        <term>lua_module</term>
        <listitem>
          <variablelist>
            <varlistentry>
              <term>required</term>
              <listitem>
                <para>required</para>
              </listitem>
            </varlistentry>
            <varlistentry>
              <term>default</term>
              <listitem>
                <para/>
              </listitem>
            </varlistentry>
            <varlistentry>
              <term>allowed</term>
              <listitem>
                <para>.+</para>
              </listitem>
            </varlistentry>
          </variablelist>
          <para>The lua module to load.</para>
        </listitem>
      </varlistentry>
    </variablelist>
    <variablelist>
      <varlistentry>
        <term>lua_function</term>
        <listitem>
          <variablelist>
            <varlistentry>
              <term>required</term>
              <listitem>
                <para>required</para>
              </listitem>
            </varlistentry>
            <varlistentry>
              <term>default</term>
              <listitem>
                <para/>
              </listitem>
            </varlistentry>
            <varlistentry>
              <term>allowed</term>
              <listitem>
                <para>.+</para>
              </listitem>
            </varlistentry>
          </variablelist>
          <para>The lua function to run in the module.</para>
        </listitem>
      </varlistentry>
    </variablelist>
    <variablelist>
      <varlistentry>
        <term>concurrent</term>
        <listitem>
          <variablelist>
            <varlistentry>
              <term>required</term>
              <listitem>
                <para>optional</para>
              </listitem>
            </varlistentry>
            <varlistentry>
              <term>default</term>
              <listitem>
                <para>false</para>
              </listitem>
            </varlistentry>
            <varlistentry>
              <term>allowed</term>
              <listitem>
                <para>(?:true|on|false|off)</para>
              </listitem>
            </varlistentry>
          </variablelist>
          <para>Specify if the function should be invoked in each concurrent eventer thread.</para>
        </listitem>
      </varlistentry>
    </variablelist>
  </section>
  <section>
    <title>Examples</title>
    <example>
      <title>Loading the lua general module an run somefunction from the somemodule module.</title>
      <programlisting>
      &lt;noit&gt;
        &lt;modules&gt;
          &lt;module image="lua_mtev" name="lua_general"&gt;
            &lt;config&gt;
              &lt;directory&gt;/some/other/path/?.lua&lt;/directory&gt;
              &lt;lua_module&gt;somemodule&lt;/lua_module&gt;
              &lt;lua_function&gt;somefunction&lt;/lua_function&gt;
            &lt;/config&gt;
          &lt;/module&gt;
        &lt;/modules&gt;
      &lt;/noit&gt;
    </programlisting>
    </example>
  </section>
</section>
